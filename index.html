<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <!-- Primary Meta Tags -->
    <title>Dhani</title>
    <link rel="icon" href="https://www.dhani.com/wp-content/uploads/2020/10/cropped-dhani-logo2-32x32.png"
        sizes="32x32" />
    <link rel="icon" href="https://www.dhani.com/wp-content/uploads/2020/10/cropped-dhani-logo2-192x192.png"
        sizes="192x192" />
    <link rel="apple-touch-icon"
        href="https://www.dhani.com/wp-content/uploads/2020/10/cropped-dhani-logo2-180x180.png" />
    <meta name="title" content="Hey there, I have sent you gifts this Festive Season!">
    <meta name="description"
        content="Let's begin this new year with Prosperity, Health, Wealth & Positivity!. Here are some gifts for you. Merry Christmas and a Happy New Year 2021">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://elated-khorana-f616b5.netlify.app/">
    <meta property="og:title" content="Hey there, I have sent you gifts this Festive Season!">
    <meta property="og:description"
        content="Let's begin this new year with Prosperity, Health, Wealth & Positivity!. Here are some gifts for you. Merry Christmas and a Happy New Year 2021">
    <meta property="og:image" content="">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://elated-khorana-f616b5.netlify.app/">
    <meta property="twitter:title" content="Hey there, I have sent you gifts this Festive Season!">
    <meta property="twitter:description"
        content="Let's begin this new year with Prosperity, Health, Wealth & Positivity!. Here are some gifts for you. Merry Christmas and a Happy New Year 2021">
    <meta property="twitter:image" content="">
</head>
<!-- CSS only -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="style.css">
    <style>
        .santabase {
            position: absolute;
            bottom: 30px;
            text-align: center;
            left: 30%;
        }
        
        
#closingbg {
    display: block;
    opacity: 1.08347;
    position: absolute;
    top: 35%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 75%;
}
    </style>
<body style="height:100vh">
    <audio src="audio/audio.mp3" id="my_audio" loop="loop" autoplay="autoplay"></audio>
    <section style="" id="main">
    <div>
        <div style="z-index:1000000; pointer-events: none;" id="snow"></div>
        <div id="bg">
            <img id="introImg" style="position: absolute; max-width:100%; z-index:1;" src="videos/intro.gif" alt="">
            <img style="position: absolute; display:none;" src="videos/GIF2.gif" alt=""> <!-- caching the gif file, do not delete this line -->
<!--          <video id="myVideo" muted autoplay>
            <source id="mp4_src" src="videos/intro.mp4" type="video/mp4">
        </video> -->
            <div id="senderBox" style="display:none; z-index:100;">
                <div style="position:relative">
                <img src="images/name_bg_03.png" style="width: 350px;">
                <span class="senderNameAll" id="senderName"></span>
                </div>
            </div>

        <img src="images/New.png" alt="Background" id="openbg" class="bg">
            <img src="images/greetings.png" alt="Background" id="closingbg" style="display:none;">
        </div>
    </div>
        <section id="wishScreen" class="wishing" style="display:none">
            <div style="top:-100% !important;" id="senderBox2">
                <div style="position:relative">
                <img src="images/name_bg_03.png" style="width: 350px;">
                <span class="senderNameAll" id="senderName"></span>
                </div>
                <img style="height: 25%" src="images/sent_03.png">
            </div>
        <div style="position: relative;" id="gifts">
                <div onclick="openGift(this)" class="giftbag" >
                    <img class="gb" data-open="images/open.png" data-close="images/potli.png" src="images/potli.png" alt="">
                    <img id="wishCard1" class="wishCard" src="images/1.png">
                </div>
                <div onclick="openGift(this)" class="giftbag" >
                    <img class="gb" data-open="images/open.png" data-close="images/potli.png" src="images/potli.png" alt="">
                    <img id="wishCard2" class="wishCard" src="images/2.png">
                </div>
                <div onclick="openGift(this)" class="giftbag" >
                    <img class="gb" data-open="images/open.png" data-close="images/potli.png" src="images/potli.png" alt="">
                    <img id="wishCard3" class="wishCard" src="images/3.png">
                </div>
                <div onclick="openGift(this)" class="giftbag" >
                    <img class="gb" data-open="images/open.png" data-close="images/potli.png" src="images/potli.png" alt="">
                    <img id="wishCard4" class="wishCard" src="images/4.png">
                </div>
        </div>
            <img style="position: absolute; left:50%; bottom: -75%; transform: translateX(-50%); height: 25%;" src="images/tap_03.png">
    </section>
    <div style="display:none;" id="santaImg" class="santabase">
        <img src="images/Santabase.png" alt="">
    </div>
    <section style="display:none; position:fixed; bottom:0px; left:0px; width:100vw;" id="share2WaBtn" class="whatsappshare">
        <div  class="whatsapp">
             <label>Share with your loved ones</label>
             <input type="text" name="content" id="content" placeholder="Enter your name" class="content" />
             <button type="submit" onclick="addname();">Share <img src="images/whatsapp_icon.svg" width="30%"></button>                  
        </div>
    </section>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"></script>
    <script type="text/javascript">
        window.onload = (event) => {
            var senderName = decodeURIComponent(window.location.search);
            senderName = senderName.slice(3, senderName.length);
            senderName = senderName.replaceAll('-', ' ');
            
            var sn = document.getElementsByClassName("senderNameAll");
            for(var s of sn) {
                s.innerText = senderName;
            }
            playVid();
        };
        var bagCount = 0;
        var x = document.getElementById("introImg");
        function playVid() {
//             x.play();
            unfade(document.getElementById("senderBox"));
            setTimeout(function(){
                myHandler();
                }, 1000);
        }

        function myHandler() {
            x.addEventListener("click", function () {
                document.getElementById("my_audio").play();
                x.src="videos/GIF2.gif";
                fade(document.getElementById("senderBox"));
                setTimeout(function(){
                    fade(x);
                    unfade(document.getElementById("wishScreen"));
                    unfade(document.getElementById("santaImg"));
                    unfade(document.getElementById("share2WaBtn"));
                }, 4000);
            });
        }
        
        function fade(element, time=50) {
            var op = 1;  // initial opacity
            var timer = setInterval(function () {
                if (op <= 0.1) {
                    clearInterval(timer);
                    element.style.display = 'none';
                }
                element.style.opacity = op;
                element.style.filter = 'alpha(opacity=' + op * 100 + ")";
                op -= op * 0.1;
            }, time);
        }
        
        function unfade(element, time=50) {
            element.style.opacity = 0;
            var op = 0.1;  // initial opacity
            element.style.display = 'block';
            var timer = setInterval(function () {
                if (op >= 1) {
                    clearInterval(timer);
                }
                element.style.opacity = op;
                element.style.filter = 'alpha(opacity=' + op * 100 + ")";
                op += op * 0.1;
            }, time);
        }
        
        function addname() {
            var name = document.getElementById('content');
            factionName = name.value;
            var url = window.location.origin + "?q=" + factionName.replaceAll(' ', '-');
            var message = " Hey there," + factionName + " has sent you gifts this Festive Season!";
            var whatsapp = "whatsapp://send?text=" + message + " " + url;
            console.log(url);
            window.open(whatsapp);
        }
        
        function openGift(el) {
            var oc = 0;
            fade(document.getElementById("senderBox2"));
            var giftbags = document.getElementsByClassName("giftbag");
            var gb,gcard;
            for(var i=0; i<giftbags.length; i++){
                gb = giftbags[i].firstElementChild;
                gcard = giftbags[i].querySelector(".wishCard")
                
//                 gb.src = gb.dataset.close;
                gcard.classList.remove("show");
                if(giftbags[i].classList.contains("opened")) {
                        oc = oc+1;
                    }
                if(giftbags[i] == el) {
                    if(!el.classList.contains("opened")) {
                        el.classList.add("opened");
                    }
                    
                    gb.src = gb.dataset.open;
                    gcard.classList.add("show");
                }
            }
            
            if(oc==3) {
                setTimeout(function(){
                    fade(document.getElementById("wishScreen"));
                    setTimeout(function(){
                        unfade(document.getElementById("closingbg"));
                    },50);
                }, 4000);
            }
        }

    </script>
   </section>
</body>

</html>
